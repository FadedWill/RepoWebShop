@model PieDetailsListViewModel

<link href="~/Content/PieDetail/List.css" rel="stylesheet" />



<div class="container" id="container">
    <div class="title-container">
        <h1 id="category-title" class="title-logo" />
    </div>
</div>

<script type="text/javascript">
    $(function () {
        $('.carousel').carousel({
            interval: 2000
        });
    });

    function getParameterByName(name){
        var regexS = "[\\?&]" + name + "=([^&#]*)",
        regex = new RegExp(regexS),
        results = regex.exec(window.location.search);
        if( results == null ){
            return "";
        } else {
            return decodeURIComponent(results[1].replace(/\+/g, " "));
        }
    }

    var category = getParameterByName("category");

    if(category)
        $('#category-title').append(category);
    else
        $('#category-title').append("Productos");

    $(document).ready(function () {
        LoadPies();
    });
        
    function LoadPies() {
        $.ajax({
            type: 'GET',
            url: '/api/PieDetailData/LoadMorePieDetails/' + category,
            dataType: 'json',
            success: onLoadSuccess,
            error: function (ex) { console.log(ex); }
        });
        return false;
    }

    function onLoadSuccess(jsonData) {
        if (jsonData == null) {
            console.log('no data returned');
            return;
        }
        $.each(jsonData, function (index, row) {
            $.get("/api/PieDetailData/GetOverview/" + row.pieDetail.pieDetailId, function(data) {
                $("#container").append(data);
            });
        });
    }
</script>
